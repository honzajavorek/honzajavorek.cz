Title: TÃ½dennÃ­ poznÃ¡mky: SÃ¡m doma
Image: images/markus-spiske-RiSAjGsa0vg-unsplash.jpg
Lang: cs
Tags: tÃ½dennÃ­ poznÃ¡mky, junior.guru
Telegram-Comments: https://t.me/honzajavorekcz/238

Jak se mi daÅ™Ã­ v jednom ÄlovÄ›ku provozovat a rozvÃ­jet [junior.guru](https://junior.guru/)?
Od [poslednÃ­ch poznÃ¡mek]({filename}2023-06-30_tydenni-poznamky-smrst-v-klubu-a-programovani-lepsiho-tydenniho-shrnuti.md) uÅ¾ utekl nÄ›jakÃ½ ten tÃ½den (30.Â 6. aÅ¾ 7.Â 7.), tak nastal Äas se opÄ›t ohlÃ©dnout a utÅ™Ã­dit si myÅ¡lenky.

![PoznÃ¡mky]({static}/images/markus-spiske-RiSAjGsa0vg-unsplash.jpg)
Fotil [Markus Spiske](https://unsplash.com/@markusspiske)

<div class="alert alert-warning" role="alert" markdown="1">
**ÄŒÃ­sla:**Â FinanÄnÃ­ vÃ½sledky, nÃ¡vÅ¡tÄ›vnost a dalÅ¡Ã­ ÄÃ­sla k junior.guru [mÃ¡m pÅ™Ã­mo na webu](https://junior.guru/open/).
AktuÃ¡lnÃ­ nabÃ­dky prÃ¡ce pro juniory: [Red Hat](https://junior.guru/jobs/aac817ee027512f150caf872e149e12ef9246815b1ecf880501b877d/)

**PlÃ¡ny:** ÄŒetli jste, co [letos plÃ¡nuji]({filename}2022-12-26_strategie-na-2023.md)?
SvÅ¯j postup zaznamenÃ¡vÃ¡m do [tabulky na GitHubu](https://github.com/orgs/juniorguru/projects/1/).
</div>

Dohodli jsme se, Å¾e rodina pojede k babiÄce a jÃ¡ budu tÃ½den kralovat sÃ¡m doma v Praze.
Jednak se mi nechtÄ›lo zase nÄ›kam jezdit, jednak jsme si takhle vÅ¡ichni od vÅ¡eho odpoÄinuli a mohli si nadÄ›lit nevÅ¡ednÃ­ zÃ¡Å¾itky, nebo fungovat bez toho, abychom se museli na nÄ›Äem domlouvat.

VÅ¯bec jsem si nevÅ¡iml, Å¾e majÃ­ bÃ½t zrovna nÄ›jakÃ© svÃ¡tky, takÅ¾e mÄ› pÅ™ekvapilo, jak mÃ¡lo lidÃ­ bylo v Praze a kolik toho bylo zavÅ™enÃ©ho.
Nemohl jsem tedy skoro nic zaÅ™Ã­dit z vÄ›cÃ­ doma, na kterÃ© jsem mÄ›l zrovna Äas.
Nakonec jsem si namÃ­chal nÄ›jakÃ½ snad rozumnÃ½ mix povinnostÃ­, zÃ¡bavy a prÃ¡ce.
Co jsem dÄ›lal ve volnÃ©m Äase?

- UklizenÃ­ celÃ©ho bytu (s podcasty v uÅ¡Ã­ch je zÃ¡bava i mytÃ­ zÃ¡chodu),
- pivo s kamarÃ¡dem, kterÃ©ho jsem nevidÄ›l tak dekÃ¡du,
- nÃ¡vÅ¡tÄ›va [nejlepÅ¡Ã­ho kina](https://kinoaero.cz/): [Asteroid City](https://www.csfd.cz/film/1069519-asteroid-city/),
- cyklovÃ½let s kamarÃ¡dem z ÃšstÃ­ do MÄ›lnÃ­ka (StÅ™edohoÅ™Ã­ ani KokoÅ™Ã­nsko prakticky neznÃ¡m, takÅ¾e poprvÃ©),
- druhÃ¡ nÃ¡vÅ¡tÄ›va [nejlepÅ¡Ã­ho kina](https://kinoaero.cz/): [â€slepÃ¡ uliÄka HolywoodskÃ½ch blockbusterÅ¯â€œ naslepo](https://www.csfd.cz/film/18204-kralovstvi-ohne/prehled/),
- cyklovÃ½let s kamarÃ¡dem, oklikou k brÃ¡chovi na zahradu, nÃ¡slednÄ› sbÄ›r Ãºrody
- sledovÃ¡nÃ­ filmu: [Pleasure](https://www.csfd.cz/film/811314-rozkos/prehled/),
- hranÃ­ si se Stable Diffusion,
- obÄ›d s kamarÃ¡dkou s miminem,
- sledovÃ¡nÃ­ F1 v Rakousku.

VÄera jsem nasedl na vlak a uÅ¾ jsme zase celÃ¡ rodinka pohromadÄ›.

![Aero]({static}/images/img-4418.jpg)
Aero

![ÃšÅ¡tÄ›k]({static}/images/img-4380.jpg)
ÃšÅ¡tÄ›k

![KokoÅ™Ã­n]({static}/images/img-4395.jpg)
KokoÅ™Ã­n

## IRL srazy v klubu

Povedlo se mi nakonec hacknout meetup.com.
KÃ³d, kterÃ½ se tam pÅ™ihlaÅ¡oval a stahoval iCalendar, jsem musel smazat, protoÅ¾e nefungoval na CI.
Meetup.com zdetekoval, Å¾e se pÅ™ihlaÅ¡uji z nÄ›jakÃ© podezÅ™elÃ© IP adresy a poslal mi na mail 2FA kÃ³d, kterÃ½ jsem mÄ›l zadat, coÅ¾ znemoÅ¾nilo jednoduchou automatizaci.

Napadlo mÄ› vÅ¡ak, Å¾e i _walled garden_ potÅ™ebuje bÃ½t na Googlu a Å¾e moÅ¾nÃ¡ na webu pouÅ¾Ã­vajÃ­ mikroformÃ¡ty ze [schema.org](https://schema.org/).
A taky Å¾e jo.
Pustil jsem na jejich HTML [extruct](https://github.com/scrapinghub/extruct/) a bylo to, mÄ›l jsem veÅ¡kerÃ¡ data o plÃ¡novanÃ½ch udÃ¡lostech.
StaÄilo to jen nÄ›jak slouÄit s iCalendar exportem z [pyvo.cz](https://pyvo.cz/) a zpracovat.

BÄ›hem pÃ¡r hodin uÅ¾ jsem pro kaÅ¾dÃ½ budoucÃ­ sraz zaklÃ¡dal udÃ¡lost na Discordu.
Nakreslil jsem k nim i obrÃ¡zky.
Bot by je mohl pÅ™Ã­mo generovat, ale Å™ekl jsem si, Å¾e rychlejÅ¡Ã­ bude, kdyÅ¾ ruÄnÄ› udÄ›lÃ¡m tÅ™i obrÃ¡zky pro tÅ™i typy srazÅ¯.
Namastil jsem to v [Canva](http://canva.com/).

PÅ™i programovÃ¡nÃ­ jsem narazil na nÄ›jakÃ© nesrovnalosti v pycordu, tak jsem zaloÅ¾il [#2160](https://github.com/Pycord-Development/pycord/issues/2160) a [#2161](https://github.com/Pycord-Development/pycord/issues/2161).
Dokonce se mi po nÄ›kolika dnech ozvali i ze supportu meetup.com, Å¾e mi rÃ¡di pomohou, ale vÅ¯bec netuÅ¡Ã­, kterÃ¡ bije, tak jestli jim mÅ¯Å¾u nahrÃ¡t video.
K tomu jsem se jeÅ¡tÄ› nedostal, ale udÄ›lÃ¡m to.
Pokud je to bug a oni vÅ¯bec nevÄ›dÃ­, Å¾e jim nÄ›kolik mÄ›sÃ­cÅ¯ nefungujÃ­ iCalendar exporty, tak to by mÄ› dost pobavilo.

![UdÃ¡losti na Discordu]({static}/images/screenshot-2023-07-07-at-12-39-43.png)
Dovedu si pÅ™edstavit, Å¾e by se to dalo dÃ¡l vylepÅ¡ovat, ale pro zaÄÃ¡tek to bude takhle staÄit

## Optimalizace buildu webu

Jedna z nejpomalejÅ¡Ã­ch vÄ›cÃ­ pÅ™i buildu webu bylo generovÃ¡nÃ­ [strÃ¡nky s grafy](https://junior.guru/open/), protoÅ¾e se tam dÄ›lÃ¡ spousta dotazÅ¯ do databÃ¡ze a spousta vÃ½poÄtÅ¯.
Napadlo mÄ›, Å¾e bych to mohl pÅ™esunout do synchronizaÄnÃ­ fÃ¡ze, tzn. Å¾e by se to jednou pÅ™edpoÄÃ­talo, uloÅ¾ilo do databÃ¡ze a pÅ™i buildu webu uÅ¾ by se to jen vypsalo.
To urychlÃ­ pÅ™edevÅ¡Ã­m lokÃ¡lnÃ­ vÃ½voj, kdy kaÅ¾dou chvilku reloaduji web.

No tak jsem to takhle udÄ›lal.
ChvÃ­li mi trvalo to sprÃ¡vnÄ› navrhnout, ale myslÃ­m, Å¾e vÃ½sledek je i flexibilnÄ›jÅ¡Ã­ a pÅ™ehlednÄ›jÅ¡Ã­, neÅ¾ jak to bylo pÅ™edtÃ­m.

PÅ™idal jsem i novÃ½ graf, [podÃ­l Å¾en mezi hosty podcastu](https://junior.guru/open/#podil-zen-mezi-hosty-podcastu) (45-55 %, hezkÃ½!).

## Obnova ztracenÃ½ch statistik

NedÃ¡vno jsem si omylem na Memberful smazal nÄ›jakÃ¡ starÃ¡ data a pÅ™ipravil jsem se tÃ­m o historii spousty produktovÃ½ch grafÅ¯, kterÃ© se tÃ½kajÃ­ ÄlenstvÃ­.
To je dost prÅ¯Å¡vih.
V Memberful API je jeÅ¡tÄ› nÄ›co, co se jmenuje _activity log_, tak jsem si myslel, Å¾e bych nÄ›kterÃ¡ ÄÃ­sla mohl obnovit z toho.

JenÅ¾e v API je toho mÃ©nÄ›, neÅ¾ co jde vidÄ›t v _activity logu_ na webu v Memberful.
ZjistÃ­m asi jen pÅ™Ã­chody a odchody lidÃ­, ale uÅ¾ ne co mÄ›li za tarif nebo za kupÃ³n, bohuÅ¾el.

TakÅ¾e je otÃ¡zka, jestli se mi bude chtÃ­t programovat nÄ›jakou netriviÃ¡lnÃ­ zÃ¡leÅ¾itost jen kvÅ¯li polovinÄ› grafÅ¯.
A jeÅ¡tÄ› bych musel vymyslet, jak ta ÄÃ­sla spojit dohromady s tÃ­m, co mÃ¡m za poslednÃ­ mÄ›sÃ­ce.
UdÄ›lal jsem _proof of concept_, ale nejsem si jistÃ½, co dÃ¡l, jestli to vlastnÄ› dotÃ¡hnu.

StaÅ¾enÃ­ dat do databÃ¡ze bylo celkem jednoduchÃ©, ale pak jsem je potÅ™eboval nÄ›jak normalizovat, aby tam nebyly duplicity.
VÅ¯bec jsem nevÄ›dÄ›l jak na to, ale ChatGPT mi to celÃ© vymyslelo!
MÅ¯j dotaz znÄ›l takhle:

> I have a database table with column "user_id" typed as number, "happening_on" typed as date, and column "activity_type", which can have only two values: begin, end.
>
> The data represents activity log. It can happen that some actions in the system result in multiple activities of the same type happening one after another. Example:
>
> user_id: 1, happening_on: 01-07-2022, activity_type: begin
> user_id: 1, happening_on: 04-07-2022, activity_type: end
> user_id: 1, happening_on: 10-07-2022, activity_type: end
> user_id: 1, happening_on: 11-07-2022, activity_type: end
> user_id: 1, happening_on: 12-07-2022, activity_type: begin
> user_id: 1, happening_on: 12-07-2022, activity_type: begin
> user_id: 1, happening_on: 13-07-2022, activity_type: begin
>
> What would you suggest me to do with the data so that I normalize the records and get rid of duplicate activites? Let's say I'd want to keep always only the first one of the same type happening for each user:
>
> user_id: 1, happening_on: 01-07-2022, activity_type: begin
> user_id: 1, happening_on: 04-07-2022, activity_type: end
> user_id: 1, happening_on: 12-07-2022, activity_type: begin

Vyplivlo to SQL, kterÃ© pouÅ¾Ã­valo nÄ›jakÃ© poddotazy a vÄ›ci, kterÃ© ani neumÃ­m pouÅ¾Ã­vat.
Tak jsem se rovnou zeptal, jestli mi to nemÅ¯Å¾e napsat v syntaxi Peewee.
A chtÄ›l jsem to bez nÄ›jakÃ© dalÅ¡Ã­ tabulky, tak mi to zase pÅ™epsal.
A nakonec jsme se dobrali ke kÃ³du, kterÃ½ po pÅ™ekopÃ­rovÃ¡nÃ­ prakticky hned fungoval.

```python
subquery = (
    ActivityLog
    .select(
        ActivityLog.id,
        fn.ROW_NUMBER().over(
            partition_by=[ActivityLog.user_id, ActivityLog.activity_type],
            order_by=[ActivityLog.happening_on]
        ).alias('row_num')
    )
    .from_(ActivityLog)
    .cte('subquery')
)

duplicate_ids = (
    ActivityLog
    .select(subquery.c.id)
    .from_(subquery)
    .where(subquery.c.row_num > 1)
)

ActivityLog.delete().where(ActivityLog.id.in_(duplicate_ids)).execute()
```

KdyÅ¾ si to Ätu, tak tuÅ¡Ã­m, co se tam dÄ›je a proÄ to funguje, ale v Å¾ivotÄ› bych takovou Å¡Ã­lenost sÃ¡m nenapsal, ani v SQL, natoÅ¾ v Peewee.
UÅ¡etÅ™ilo mi to hromadu prÃ¡ce.
Pokud to teda funguje!
MusÃ­m si na to jeÅ¡tÄ› napsat testy.

## Optimalizace obrÃ¡zkÅ¯

NoÄnÃ­ CI workflow, kterÃ© formÃ¡tuje kÃ³d a pushuje zpÃ¡tky na GitHub, jsem pÅ™ejmenoval z `format` na `tidyup` a doplnil jej o dalÅ¡Ã­ vÄ›ci.
TeÄ to umÃ­ zmenÅ¡it avatary na 500x500 px, pokud jsou vÄ›tÅ¡Ã­, a optimalizovat trochu jejich JPG kompresi.
A taky to umÃ­ optimalizovat SVG.
Tyto vÄ›ci se tedy dÄ›jÃ­ jednou za den a zmÄ›ny se commitnou zpÄ›t do gitu, takÅ¾e na to sÃ¡m nemusÃ­m nijak zvlÃ¡Å¡Å¥ myslet.

GenerovanÃ© obrÃ¡zky (plakÃ¡tky k podcastu, pÅ™ednÃ¡Å¡kÃ¡mâ€¦) se novÄ› pÅ™enÃ¡Å¡ejÃ­ z buildu na build pÅ™es CircleCI cache.
To znamenÃ¡, Å¾e stejnÃ½ obrÃ¡zek se nebude generovat znova a znova a Å¡etÅ™Ã­ se Äas.
Ale taky to znamenÃ¡, Å¾e starÃ½, nepotÅ™ebnÃ½ obrÃ¡zek, by tam zÅ¯stal navÄ›ky.
Tak jsem doplnil vÄ›c, kterÃ¡ sleduje, kterÃ© generovanÃ© obrÃ¡zky jsou opravdu potÅ™eba a starÃ© nepotÅ™ebnÃ© smaÅ¾e.

TÃ­mto jsem prozatÃ­m ukonÄil svoje pÅ™ebudovÃ¡vÃ¡nÃ­ toho, jak na junior.guru funguje build frontendu.
Zabralo to vÃ­c Äasu, neÅ¾ jsem myslel, ale s vÃ½sledkem jsem celkem spokojen.
VyÅ™eÅ¡il jsem spoustu malÃ½ch otravnÃ½ch problÃ©mÅ¯ a celÃ© jsem to dost zrychlil, coÅ¾ by mÄ›lo i podpoÅ™it mou chuÅ¥ na frontendu nÄ›co dÄ›lat.

## DalÅ¡Ã­

-   VyÅ¡ly se mnou [Newslettery.cz](https://www.newslettery.cz/p/cerven-2023)!
-   Doladil jsem sluÄovÃ¡nÃ­ dat na CI, kterÃ© se dÄ›lÃ¡ po paralelizaci skriptÅ¯.
    DoÅ¡lo mi, Å¾e nechci sluÄovat soubory se staÅ¾enÃ½mi nabÃ­dkami prÃ¡ce, protoÅ¾e pokud uÅ¾ se ten den stÃ¡hly, tak se vÅ¯bec nemajÃ­ stahovat znova.
    Velmi to zjednoduÅ¡ilo kÃ³d, spoustu vÄ›cÃ­ jsem smazal.
-   Dal jsem si zÃ¡leÅ¾et, abych byl tentokrÃ¡t ve sprÃ¡vnÃ½ Äas na sprÃ¡vnÃ©m mÃ­stÄ›, ale stejnÄ› se nÃ¡m nepovedlo jako vÃ½bor Pyvce sejÃ­t.
    ZaÄÃ­nÃ¡m to vnÃ­mat jako vÄ›tÅ¡Ã­ a vÄ›tÅ¡Ã­ problÃ©m, tohle musÃ­me nÄ›jak vyÅ™eÅ¡it.
-   UdÄ›lal jsem upgrade na [novÃ½ Bootstrap](https://blog.getbootstrap.com/2023/05/30/bootstrap-5-3-0/), kterÃ½ umÃ­ _dark mode_.
    AkorÃ¡t na junior.guru teda jeÅ¡tÄ› _dark mode_ nebude, to budu muset celÃ© jeÅ¡tÄ› prozkoumat, pÅ™eÄÃ­st si [MichÃ¡lka](https://www.vzhurudolu.cz/prirucka/dark-mode), atd.
-   ProÄistil jsem si jeden sloupec v Trellu a vyhÃ¡zel kartiÄky, kterÃ© jsou uÅ¾ nerelevantnÃ­, nebo hotovÃ©.
-   PÅ™edÄ›lal jsem na Discordu kanÃ¡l na hÃ¡danky a Å¡ifry z textovÃ©ho na forum.
    [MÃ­la](https://milavotradovec.cz/) ho chce propojit s [Å ifrovaÄkami](https://sifrovacky.cz/).
-   Call s ENGETO Academy. Kecali jsme nÄ›jak dlouho, tak jsme si dali jeÅ¡tÄ› druhÃ½ na pÅ™Ã­Å¡tÃ­ tÃ½den.
    Odpadla nÃ¡m kamarÃ¡dka na dotaznÃ­k a my asi vzdÃ¡me to, aby to vidÄ›l nÄ›jakÃ½ odbornÃ­k.
    UÅ¾ teÄ na tom dÄ›lÃ¡me nÄ›kdy od listopadu a furt to nenÃ­ venku, pÅ™itom jak jÃ¡, tak ENGETO preferujeme spÃ­Å¡ zpÅ¯sob â€zkusit, pouÄit se, zkusit znovaâ€œ a ne nÄ›co rok ladit.
-   ENGETO bude hledat seniornÃ­ho vÃ½vojÃ¡Å™e, tak jsem jim mrknul na inzerÃ¡t.
    MÄ›l jsem k tomu spoustu pÅ™ipomÃ­nek a komentÃ¡Å™Å¯, tak snad jsem to moc nerozcupoval na kousky.
-   E-maily, [klubovÃ½ Discord](https://junior.guru/club/), [Pyvec Slack](https://docs.pyvec.org/operations/support.html#sit-kontaktu).
-   BÄ›hem 8 dnÃ­ jsem ujel na kole 143Â km. Celkem jsem se hÃ½bal 18Â h a zdolal pÅ™i tom 143Â km.
    Detaily na [Strava](https://www.strava.com/athletes/31242569), jedinÃ© sociÃ¡lnÃ­ sÃ­ti, kde si napsÃ¡nÃ­ statusu musÃ­te zaslouÅ¾it.

<div class="alert alert-warning" role="alert" markdown="1">
**OkÃ©nko duÅ¡evnÃ­ho zdravÃ­:**
MÃ¡te dojem, Å¾e na rozdÃ­l ode mnÄ› nic nestÃ­hÃ¡te?
BuÄte v klidu, [nenÃ­ to zÃ¡vod]({filename}2020-06-04_neni-to-zavod.md)!
</div>

## PlÃ¡nuji

1.  Pod kaÅ¾dou strÃ¡nkou pÅ™Ã­ruÄky bude â€komentÃ¡Å™ovÃ¡ sekceâ€œ, ve skuteÄnosti reklama na klub.
2.  DÄ›lat promo vÄ›cem, kterÃ½m mÃ¡m dÄ›lat promo.
3.  Rozhodnout se co s tÄ›mi ztracenÃ½mi metrikami na [/open/](https://junior.guru/open/).

## Zaujalo mÄ›

KdyÅ¾ na nÄ›co narazÃ­m a lÃ­bÃ­ se mi to, sdÃ­lÃ­m to [na Telegramu](https://t.me/honzajavorekcz).
Od poslednÃ­ch poznÃ¡mek jsem sdÃ­lel:

- [Your People](https://randsinrepose.com/archives/your-people/)<br>ProÄ se vyplatÃ­ mÃ­t â€svoje lidiâ€œ? ZajÃ­mavÃ½ postÅ™eh od Randse.
- [edu.digital - 7 dÅ¯vodÅ¯, proÄ stÃ¡tnÃ­ IT nefunguje (zÃ¡znam)](https://www.youtube.com/watch?v=PhS2qoEOjJk)<br>Super vhled od Jakuba Onderky do toho, proÄ nefunguje IT ve stÃ¡tnÃ­ sprÃ¡vÄ›. Je to delÅ¡Ã­, ale pustil jsem si to k vaÅ™enÃ­ obÄ›da a Å¡lo to. AkorÃ¡t to trochu zkazilo chuÅ¥ ğŸ˜…
- [ÄŒerven 2023: Honza Javorek o placenÃ© komunitÄ›](https://www.newslettery.cz/p/cerven-2023)<br>:)
